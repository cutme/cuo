/*!
 * @pluginjs/scroll-progress v0.7.18 (https://pluginjs.com)
 * Copyright 2019 Creation Studio Limited
 * Released under the GPL-3.0 License.
 */
import t from"@pluginjs/component";import i from"@pluginjs/template";import s from"@pluginjs/factory";import{addClass as e,hasClass as o,removeClass as r}from"@pluginjs/classes";import{setStyle as n}from"@pluginjs/styled";import{bindEvent as l,removeEvent as h}from"@pluginjs/events";import{query as a,parseHTML as c,prepend as d}from"@pluginjs/dom";import{styleable as p,eventable as m,stateable as b,optionable as g,register as u}from"@pluginjs/decorator";var E,f={READY:"ready",ENABLE:"enable",DISABLE:"disable",DESTROY:"destroy",REFRESH:"refresh"},B={NAMESPACE:"pj-".concat("scrollProgress"),BAR:"{namespace}-bar",DISABLED:"{namespace}-disabled"},v={size:5,color:"#50bcb6",opacity:1,custom:!0,appendTo:"body",position:"top-left",templates:{bar:()=>'<div class="{classes.BAR}"></div>'}},A=["top-left","top-right","bottom-left","bottom-right","left-bottom","left-top","right-bottom","right-top"],y=p(B)(E=m(f)(E=b()(E=g(v,!0)(E=u("scrollProgress",{methods:["enable","disable","destroy","refresh"]})(E=class extends t{constructor(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t),this.setupOptions(i),this.setupClasses(),this.setupStates(),this.initialize()}initialize(){e(this.classes.NAMESPACE,this.element),this.$bar=a(".".concat(this.classes.BAR))?a(".".concat(this.classes.BAR)):c(this.creatHtml()),this.position=A.includes(this.options.position)?this.options.position:A[0],this.direction=this.getDirection(),this.resetBarPosition(),d(this.$bar,a(this.options.appendTo)),this.bind(),!0===this.options.custom&&this.initBar(),this.enter("initialized"),this.trigger(f.READY)}setBardefaultAttr(){"vertical"===this.direction?n({width:this.options.size,backgroundColor:this.options.color,opacity:this.options.opacity},this.$bar):n({height:this.options.size,backgroundColor:this.options.color,opacity:this.options.opacity},this.$bar)}resetBarPosition(){if(!o(this.getClass("{namespace}-".concat(this.position)),this.$bar)){this.setBardefaultAttr();for(var t=0;t<A.length;t++)r(this.getClass("{namespace}-".concat(A[t])),this.$bar);e(this.getClass("{namespace}-".concat(this.position)),this.$bar)}}getDirection(){var t=this.position.split("-")[0];return"left"===t||"right"===t?"vertical":"level"}scrollTop(){return window.pageYOffset||document.documentElement.scrollTop}initBar(){var t=this.scrollTop(),i=document.documentElement.clientHeight,s=t/(document.body.scrollHeight-i)*100;this.setBarSize(s)}setBarSize(t){"vertical"===this.direction?n("height","".concat(t,"%"),this.$bar):n("width","".concat(t,"%"),this.$bar)}bind(){this.bindElement=this.options.custom?this.element:document.body,this.options.custom&&this.bindElement!==document.body?l(this.eventName("scroll"),this.scrollHandle.bind(this),this.bindElement):s.emitter.on(this.eventNameWithId("scroll"),this.scrollHandle.bind(this))}unbind(){this.setBarSize(0),this.options.custom&&this.bindElement!==document.body?h(this.eventName(),this.bindElement):s.emitter.off(this.eventNameWithId("scroll"))}scrollHandle(){if(!this.is("disabled")){var t,i,s;this.resetBarPosition(),!1===this.options.custom?(s=this.scrollTop(),t=document.documentElement.clientHeight,i=document.body.scrollHeight):(s=this.element.scrollTop,t=this.element.clientHeight,i=this.element.scrollHeight);var e=s/(i-t)*100;this.setBarSize(e)}}creatHtml(){return i.render(this.options.templates.bar.call(this),{classes:this.classes})}refresh(){this.scrollHandle(),this.trigger(f.REFRESH)}enable(){this.is("disabled")&&(r(this.classes.DISABLED,this.element),this.leave("disabled")),this.trigger(f.ENABLE)}disable(){this.is("disabled")||(e(this.classes.DISABLED,this.element),this.enter("disabled")),this.trigger(f.DISABLE)}destroy(){this.is("initialized")&&(this.unbind(),this.leave("initialized")),this.trigger(f.DESTROY),super.destroy()}})||E)||E)||E)||E)||E;export default y;
