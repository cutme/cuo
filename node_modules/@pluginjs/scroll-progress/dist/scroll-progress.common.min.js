/*!
 * @pluginjs/scroll-progress v0.7.18 (https://pluginjs.com)
 * Copyright 2019 Creation Studio Limited
 * Released under the GPL-3.0 License.
 */
"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var _dec,_dec2,_dec3,_dec4,_dec5,_class,Component=_interopDefault(require("@pluginjs/component")),templateEngine=_interopDefault(require("@pluginjs/template")),Pj=_interopDefault(require("@pluginjs/factory")),classes$1=require("@pluginjs/classes"),styled=require("@pluginjs/styled"),events$1=require("@pluginjs/events"),dom=require("@pluginjs/dom"),decorator=require("@pluginjs/decorator"),namespace="scrollProgress",events={READY:"ready",ENABLE:"enable",DISABLE:"disable",DESTROY:"destroy",REFRESH:"refresh"},classes={NAMESPACE:"pj-".concat(namespace),BAR:"{namespace}-bar",DISABLED:"{namespace}-disabled"},methods=["enable","disable","destroy","refresh"],defaults={size:5,color:"#50bcb6",opacity:1,custom:!0,appendTo:"body",position:"top-left",templates:{bar:()=>'<div class="{classes.BAR}"></div>'}},POSITIONS=["top-left","top-right","bottom-left","bottom-right","left-bottom","left-top","right-bottom","right-top"],ScrollProgress=(_dec=decorator.styleable(classes))(_class=(_dec2=decorator.eventable(events))(_class=(_dec3=decorator.stateable())(_class=(_dec4=decorator.optionable(defaults,!0))(_class=(_dec5=decorator.register(namespace,{methods:methods}))(_class=class extends Component{constructor(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e),this.setupOptions(t),this.setupClasses(),this.setupStates(),this.initialize()}initialize(){classes$1.addClass(this.classes.NAMESPACE,this.element),this.$bar=dom.query(".".concat(this.classes.BAR))?dom.query(".".concat(this.classes.BAR)):dom.parseHTML(this.creatHtml()),this.position=POSITIONS.includes(this.options.position)?this.options.position:POSITIONS[0],this.direction=this.getDirection(),this.resetBarPosition(),dom.prepend(this.$bar,dom.query(this.options.appendTo)),this.bind(),!0===this.options.custom&&this.initBar(),this.enter("initialized"),this.trigger(events.READY)}setBardefaultAttr(){"vertical"===this.direction?styled.setStyle({width:this.options.size,backgroundColor:this.options.color,opacity:this.options.opacity},this.$bar):styled.setStyle({height:this.options.size,backgroundColor:this.options.color,opacity:this.options.opacity},this.$bar)}resetBarPosition(){if(!classes$1.hasClass(this.getClass("{namespace}-".concat(this.position)),this.$bar)){this.setBardefaultAttr();for(var e=0;e<POSITIONS.length;e++)classes$1.removeClass(this.getClass("{namespace}-".concat(POSITIONS[e])),this.$bar);classes$1.addClass(this.getClass("{namespace}-".concat(this.position)),this.$bar)}}getDirection(){var e=this.position.split("-")[0];return"left"===e||"right"===e?"vertical":"level"}scrollTop(){return window.pageYOffset||document.documentElement.scrollTop}initBar(){var e=this.scrollTop(),t=document.documentElement.clientHeight,s=e/(document.body.scrollHeight-t)*100;this.setBarSize(s)}setBarSize(e){"vertical"===this.direction?styled.setStyle("height","".concat(e,"%"),this.$bar):styled.setStyle("width","".concat(e,"%"),this.$bar)}bind(){this.bindElement=this.options.custom?this.element:document.body,this.options.custom&&this.bindElement!==document.body?events$1.bindEvent(this.eventName("scroll"),this.scrollHandle.bind(this),this.bindElement):Pj.emitter.on(this.eventNameWithId("scroll"),this.scrollHandle.bind(this))}unbind(){this.setBarSize(0),this.options.custom&&this.bindElement!==document.body?events$1.removeEvent(this.eventName(),this.bindElement):Pj.emitter.off(this.eventNameWithId("scroll"))}scrollHandle(){if(!this.is("disabled")){var e,t,s;this.resetBarPosition(),!1===this.options.custom?(s=this.scrollTop(),e=document.documentElement.clientHeight,t=document.body.scrollHeight):(s=this.element.scrollTop,e=this.element.clientHeight,t=this.element.scrollHeight);var i=s/(t-e)*100;this.setBarSize(i)}}creatHtml(){return templateEngine.render(this.options.templates.bar.call(this),{classes:this.classes})}refresh(){this.scrollHandle(),this.trigger(events.REFRESH)}enable(){this.is("disabled")&&(classes$1.removeClass(this.classes.DISABLED,this.element),this.leave("disabled")),this.trigger(events.ENABLE)}disable(){this.is("disabled")||(classes$1.addClass(this.classes.DISABLED,this.element),this.enter("disabled")),this.trigger(events.DISABLE)}destroy(){this.is("initialized")&&(this.unbind(),this.leave("initialized")),this.trigger(events.DESTROY),super.destroy()}})||_class)||_class)||_class)||_class)||_class;module.exports=ScrollProgress;
